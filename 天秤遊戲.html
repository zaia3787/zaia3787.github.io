<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>å‹•ç‰©å¤©ç§¤æ’åºæŒ‘æˆ° - å®Œæ•´æ•™å­¸ç‰ˆ</title>
    <style>
        :root {
            --bg-color: #f7f9fc;
            --table-color: #e0c097;
            --accent-color: #2c3e50;
            --success-color: #2ecc71;
            --heavy-color: #e74c3c;
        }
        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        /* åˆå§‹é®ç½©èˆ‡çµæœè¦–çª— */
        #overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.92);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
            text-align: center;
            padding: 20px;
        }
        #start-btn {
            padding: 20px 50px;
            font-size: 1.8rem;
            background: var(--success-color);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            margin-top: 30px;
        }

        #header {
            width: 100%;
            padding: 15px;
            background: var(--accent-color);
            color: white;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        /* æ¡Œé¢ï¼šè‡ªç”±æ“ºæ”¾å€ */
        #tabletop {
            width: 95%;
            height: 380px;
            background-color: var(--table-color);
            margin: 10px;
            border-radius: 8px;
            position: relative; 
            border: 5px solid #5d4037;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        /* å¤©ç§¤å€ */
        #scale-area {
            display: flex;
            align-items: center;
            gap: 40px;
            margin: 10px 0;
            background: #fff;
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .pan-container { display: flex; flex-direction: column; align-items: center; }
        .pan {
            width: 85px; height: 85px;
            border: 4px solid #7f8c8d;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            background: #ecf0f1;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #scale-status { font-size: 2.5rem; min-width: 60px; text-align: center; }
        .status-text { font-weight: bold; font-size: 0.9rem; height: 1.2rem; }

        /* åº•éƒ¨ A-H æ’æ§½ */
        #dock {
            display: flex;
            gap: 10px;
            background: #34495e;
            padding: 15px;
            border-radius: 15px 15px 0 0;
            width: 90%;
            justify-content: center;
        }
        .slot-container { display: flex; flex-direction: column; align-items: center; }
        .slot {
            width: 60px; height: 60px;
            border: 2px dashed #bdc3c7;
            display: flex; justify-content: center; align-items: center;
            border-radius: 5px;
            background: rgba(255,255,255,0.05);
            transition: background 0.3s;
        }
        .slot.correct {
            background: var(--success-color) !important;
            box-shadow: 0 0 15px var(--success-color);
            border: 2px solid white;
        }
        .slot-label { color: white; margin-top: 5px; font-weight: bold; }

        /* å‹•ç‰©ç‰©ä»¶ */
        .weight {
            width: 60px; height: 60px;
            font-size: 45px;
            cursor: grab;
            display: flex; justify-content: center; align-items: center;
            user-select: none;
            position: absolute;
            z-index: 10;
        }
        .weight.in-container { position: static; }

        .btn-submit {
            padding: 12px 30px;
            background: var(--success-color);
            color: white; border: none; border-radius: 5px;
            font-weight: bold; cursor: pointer; font-size: 1rem;
        }
    </style>
</head>
<body>

<div id="overlay">
    <h1 id="overlay-title">ğŸ¦ å‹•ç‰©é‡é‡æ’åºæŒ‘æˆ° ğŸ˜</h1>
    <p id="overlay-msg">æº–å‚™å¥½ä½¿ç”¨åˆä½µæ’åºæ³•äº†å—ï¼Ÿ<br>æ¯æ¬¡é–‹å§‹ï¼Œæ‰€æœ‰å‹•ç‰©çš„é‡é‡éƒ½æœƒéš¨æ©Ÿå¤§æ´—ç‰Œï¼</p>
    <button id="start-btn" onclick="startGame()">é–‹å§‹éŠæˆ²</button>
</div>

<div id="header">
    <div style="font-size: 1.2rem;">â±ï¸ è¨ˆæ™‚ï¼š<span id="timer">0</span> ç§’</div>
    <button class="btn-submit" onclick="checkAnswer()">æäº¤ç­”æ¡ˆ</button>
</div>

<div id="tabletop" ondrop="dropToTable(event)" ondragover="allowDrop(event)">
    </div>

<div id="scale-area">
    <div class="pan-container">
        <div id="text-l" class="status-text"></div>
        <div id="pan-left" class="pan" ondrop="dropToPan(event, 'left')" ondragover="allowDrop(event)"></div>
    </div>
    <div id="scale-status">âš–ï¸</div>
    <div class="pan-container">
        <div id="text-r" class="status-text"></div>
        <div id="pan-right" class="pan" ondrop="dropToPan(event, 'right')" ondragover="allowDrop(event)"></div>
    </div>
</div>

<div id="dock">
    </div>

<script>
    const labels = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'];
    const animals = ['ğŸ¶', 'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼'];
    let startTime;
    let timerInterval;

    function startGame() {
        document.getElementById('overlay').style.display = 'none';
        // æ¸…ç†ç’°å¢ƒ
        document.getElementById('tabletop').innerHTML = '';
        document.getElementById('dock').innerHTML = '';
        document.getElementById('pan-left').innerHTML = '';
        document.getElementById('pan-right').innerHTML = '';
        updateScale();
        
        startTime = Date.now();
        initGame();
    }

    function initGame() {
        const table = document.getElementById('tabletop');
        const dock = document.getElementById('dock');
        
        // ç”Ÿæˆ 8 å€‹éš¨æ©Ÿé‡é‡
        let values = [];
        while(values.length < 8) {
            let r = Math.floor(Math.random() * 800) + 10;
            if(!values.includes(r)) values.push(r);
        }

        // æ´—ç‰Œå‹•ç‰©
        const shuffledAnimals = [...animals].sort(() => Math.random() - 0.5);

        // ç”Ÿæˆå‹•ç‰©ä¸¦éš¨æ©Ÿæ”¾ç½®åœ¨æ¡Œé¢
        values.forEach((v, i) => {
            const w = document.createElement('div');
            w.className = 'weight';
            w.id = 'animal-' + i;
            w.draggable = true;
            w.innerHTML = shuffledAnimals[i];
            w.dataset.weight = v;
            
            // éš¨æ©Ÿåˆ†ä½ˆåº§æ¨™
            w.style.left = (Math.random() * 80 + 5) + '%';
            w.style.top = (Math.random() * 60 + 5) + '%';
            w.addEventListener('dragstart', drag);
            table.appendChild(w);
        });

        // ç”Ÿæˆåº•éƒ¨æ’æ§½
        labels.forEach(l => {
            const container = document.createElement('div');
            container.className = 'slot-container';
            const slot = document.createElement('div');
            slot.className = 'slot';
            slot.id = 'slot-' + l;
            slot.addEventListener('drop', (e) => dropToSlot(e, l));
            slot.addEventListener('dragover', allowDrop);
            const label = document.createElement('div');
            label.className = 'slot-label';
            label.innerText = l;
            container.appendChild(slot);
            container.appendChild(label);
            dock.appendChild(container);
        });

        if(timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            document.getElementById('timer').innerText = Math.floor((Date.now() - startTime) / 1000);
        }, 1000);
    }

    function allowDrop(ev) { ev.preventDefault(); }
    function drag(ev) { ev.dataTransfer.setData("text", ev.target.id); }

    // è‡ªç”±æ“ºæ”¾é‚è¼¯
    function dropToTable(ev) {
        ev.preventDefault();
        const data = ev.dataTransfer.getData("text");
        const el = document.getElementById(data);
        const table = document.getElementById('tabletop');
        
        table.appendChild(el);
        el.className = 'weight';
        const rect = table.getBoundingClientRect();
        
        // ç²¾ç¢ºåº§æ¨™è¨ˆç®—
        el.style.left = (ev.clientX - rect.left - 30) + 'px';
        el.style.top = (ev.clientY - rect.top - 30) + 'px';
        el.style.position = 'absolute';
        
        updateScale();
    }

    function dropToPan(ev, side) {
        ev.preventDefault();
        const data = ev.dataTransfer.getData("text");
        const el = document.getElementById(data);
        const pan = document.getElementById('pan-' + side);
        el.className = 'weight in-container';
        el.style.position = 'static';
        pan.innerHTML = '';
        pan.appendChild(el);
        updateScale();
    }

    function dropToSlot(ev, label) {
        ev.preventDefault();
        const data = ev.dataTransfer.getData("text");
        const el = document.getElementById(data);
        const slot = document.getElementById('slot-' + label);
        el.className = 'weight in-container';
        el.style.position = 'static';
        slot.innerHTML = '';
        slot.appendChild(el);
        updateScale();
    }

    function updateScale() {
        const lp = document.getElementById('pan-left');
        const rp = document.getElementById('pan-right');
        const st = document.getElementById('scale-status');
        const tl = document.getElementById('text-l');
        const tr = document.getElementById('text-r');

        lp.style.transform = "translateY(0)";
        rp.style.transform = "translateY(0)";
        tl.innerText = ""; tr.innerText = "";

        if (lp.firstChild && rp.firstChild) {
            const wL = parseInt(lp.firstChild.dataset.weight);
            const wR = parseInt(rp.firstChild.dataset.weight);
            if (wL > wR) {
                st.innerText = "â—€ï¸";
                lp.style.transform = "translateY(20px)";
                rp.style.transform = "translateY(-20px)";
                tl.innerText = "é‡ HEAVY"; tl.style.color = "var(--heavy-color)";
                tr.innerText = "è¼• LIGHT"; tr.style.color = "var(--success-color)";
            } else if (wL < wR) {
                st.innerText = "â–¶ï¸";
                lp.style.transform = "translateY(-20px)";
                rp.style.transform = "translateY(20px)";
                tl.innerText = "è¼• LIGHT"; tl.style.color = "var(--success-color)";
                tr.innerText = "é‡ HEAVY"; tr.style.color = "var(--heavy-color)";
            }
        } else {
            st.innerText = "âš–ï¸";
        }
    }

    function checkAnswer() {
        let userOrder = [];
        let isComplete = true;

        labels.forEach(l => {
            const s = document.getElementById('slot-' + l);
            if (s.firstChild) {
                userOrder.push({
                    emoji: s.firstChild.innerHTML,
                    weight: parseInt(s.firstChild.dataset.weight)
                });
            } else {
                isComplete = false;
            }
        });

        if (!isComplete) {
            alert("è«‹å…ˆå°‡ 8 éš»å‹•ç‰©å…¨éƒ¨æ”¾å…¥ A-H æ§½ï¼");
            return;
        }

        // å–å¾—æ­£ç¢ºæ’åº
        let allWeights = [];
        const allElements = document.querySelectorAll('.weight');
        allElements.forEach(el => {
            allWeights.push({
                emoji: el.innerHTML,
                weight: parseInt(el.dataset.weight)
            });
        });
        allWeights.sort((a, b) => a.weight - b.weight);

        // åˆ¤æ–·å°éŒ¯
        let isCorrect = true;
        for (let i = 0; i < userOrder.length; i++) {
            if (userOrder[i].weight !== allWeights[i].weight) {
                isCorrect = false;
                break;
            }
        }

        clearInterval(timerInterval);
        const time = document.getElementById('timer').innerText;

        if (isCorrect) {
            labels.forEach(l => document.getElementById('slot-' + l).classList.add('correct'));
        }

        // é¡¯ç¤ºçµæœ
        setTimeout(() => {
            let resultTitle = isCorrect ? "ğŸ† æŒ‘æˆ°æˆåŠŸï¼" : "âŒ æ’åºéŒ¯èª¤";
            let userStr = userOrder.map(i => i.emoji).join(' â†’ ');
            let correctStr = allWeights.map(i => `${i.emoji}(${i.weight})`).join(' â†’ ');
            
            let msg = isCorrect 
                ? `å¤ªæ£’äº†ï¼ä½ èŠ±äº† ${time} ç§’å®Œæˆæ­£ç¢ºæ’åºã€‚\n\næ­£ç¢ºåºåˆ—ï¼š\n${correctStr}`
                : `å†æ¥å†å²ï¼\n\nä½ çš„æ’åºï¼š\n${userStr}\n\næ­£ç¢ºåºåˆ—(è¼•åˆ°é‡)ï¼š\n${correctStr}`;
            
            document.getElementById('overlay-title').innerText = resultTitle;
            document.getElementById('overlay-msg').innerText = msg;
            document.getElementById('overlay-msg').style.whiteSpace = "pre-wrap";
            document.getElementById('start-btn').innerText = "å†æŒ‘æˆ°ä¸€æ¬¡";
            document.getElementById('overlay').style.display = 'flex';
        }, 800);
    }
</script>

</body>
</html>